# ch4. 리포지터리와 모델 구현

### 4.1 JPA를 이용한 리포지터리 구현
- 도메인 모델과 리포지토리를 구현할 때 선호하는 기술을 꼽자면 JPA를 들 수 있다.
- 데이터 보관소로 RDBMS를 사용할 때, 객체 기반의 도메인 모델과 관계형 데이터 모델 간의 매핑을 처리하는 기술로 ORM 만한 것이 없다.
- JPA는 자바의 ORM 표준이다.

#### 4.1.1 모듈 위치
<img src="https://velog.velcdn.com/images/andy230/post/b648c89a-7c8e-45f2-a919-c85c0c6dab6b/image.png
" width=400px>

- 리포지터리 인터페이스는 애그리거트와 같이 도메인 영역에 속하고, 리포지터리를 구현한 클래스는 인프라스트럭처 영역에 속한다.
- 팀 표준에 따라 리포지터리 구현 클래스를 `domain.impl`과 같은 패키지에 위치시킬 수도 있는데, 가능하면 리포지터리 구현 클래스를 인프라스트럭처 영역에 위치시켜서 인프라스트럭처에 대한 의존을 낮춰야 한다.

#### 4.1.2 리포지터리 기본 기능 구현
- 리포지터리가 제공하는 기본 기능
    - ID로 애그리거트 조회하기
    - 애그리거트 저장하기
```java
public interface OrderRepository{
    Order findById(OrderNo no);
    void save(Order order);

    // null을 사용하고 싶지 않다면 Optional을 사용해도 된다.
    Optional<Order> findById(OrderNo no);
}
```
- 대부분의 경우 스프링과 JPA로 구현할 때 스프링 데이터 JPA를 사용한다. 리포지터리 인터페이스만 정의하면 나머지 리포지터리 구현 객체는 스프링 데이터 JPA가 알아서 만들어준다. 그래서 실질적으로 리포지터리 인터페이스를 구현한 클래스를 직접 작성할 일은 거의 없다.